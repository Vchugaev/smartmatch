# ü§ñ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–µ—à–∞—è –ø—Ä–æ–±–ª–µ–º—É "Foreign key constraint violated" –∏ —É–ª—É—á—à–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç.

## üéØ –ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞: `Foreign key constraint violated on the constraint: jobs_hrId_fkey`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –≤—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏
- –ù–µ—É–¥–æ–±–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### AutoProfileService
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π:

```typescript
// –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
ensureProfileExists(userId: string, userRole: UserRole): Promise<string>
getProfileId(userId: string, userRole: UserRole): Promise<string>
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –ø—Ä–æ—Ñ–∏–ª–µ–π:
- **HR** ‚Üí `HRProfile`
- **CANDIDATE** ‚Üí `CandidateProfile` 
- **UNIVERSITY** ‚Üí `UniversityProfile`

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1. –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```typescript
// AuthService.register()
const user = await this.prisma.user.create({...});

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å
await this.autoProfileService.ensureProfileExists(user.id, role);
```

### 2. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∞–∫–∞–Ω—Å–∏–∏
```typescript
// JobsService.create()
const hrProfileId = await this.autoProfileService.getProfileId(userId, user.role);
```

### 3. –ü—Ä–∏ –ª—é–±—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏
```typescript
// –õ—é–±–æ–π —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
const profileId = await this.autoProfileService.getProfileId(userId, userRole);
```

## üìã –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

### HR –ü—Ä–æ—Ñ–∏–ª—å
```typescript
{
  firstName: 'HR',
  lastName: 'Manager', 
  company: '–ö–æ–º–ø–∞–Ω–∏—è',
  position: 'HR Manager'
}
```

### –ö–∞–Ω–¥–∏–¥–∞—Ç –ü—Ä–æ—Ñ–∏–ª—å
```typescript
{
  firstName: '–ö–∞–Ω–¥–∏–¥–∞—Ç',
  lastName: '–°–æ–∏—Å–∫–∞—Ç–µ–ª—å',
  isAvailable: true
}
```

### –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –ü—Ä–æ—Ñ–∏–ª—å
```typescript
{
  name: '–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç',
  address: '–ê–¥—Ä–µ—Å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞'
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–û—Ç–∫—Ä–æ–π—Ç–µ `test-auto-profiles.html` –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è HR** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ HR –ø—Ä–æ—Ñ–∏–ª—è
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Candidate –ø—Ä–æ—Ñ–∏–ª—è  
3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ University –ø—Ä–æ—Ñ–∏–ª—è
4. **–°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ HR –ø—Ä–æ—Ñ–∏–ª—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è HR
curl -X POST http://localhost:3000/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"hr@test.com","password":"password","role":"HR"}'

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏ (–ø—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
curl -X POST http://localhost:3000/jobs \
  -H "Content-Type: application/json" \
  -H "Cookie: access_token=TOKEN" \
  -d '{"title":"Developer","description":"Job","location":"Moscow","type":"FULL_TIME","experienceLevel":"JUNIOR"}'
```

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è** - –∏—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å
2. **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏** - —Å–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
3. **–í–æ–∑–≤—Ä–∞—Ç ID** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - graceful handling –æ—à–∏–±–æ–∫

## üéâ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **üöÄ –£–ª—É—á—à–µ–Ω–Ω—ã–π UX** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –≤—Ä—É—á–Ω—É—é
- **üîß –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è–º–∏
- **üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ—Ç –æ—à–∏–±–æ–∫ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–ª—é—á–∞
- **üîÑ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –ø—Ä–æ—Ñ–∏–ª–µ–π

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ—Ñ–∏–ª–µ–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
